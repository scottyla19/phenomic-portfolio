{"date":"2017-01-01","title":"React PWA Notes","desc":"Notes while creating my portfolio site. Includes gotchas with service workers, sw-precache, manifext.json.","tags":"React, PWA","author":"Scott LaForest","posted":"07/06/17","body":{"c":[{"c":[{"c":"#","p":{"href":"#notes","className":"phenomic-HeadingAnchor"},"t":"a"},"Notes"],"p":{"id":"notes"},"t":"h1"},"\n",{"c":[{"c":"#","p":{"href":"#service-worker-with-react","className":"phenomic-HeadingAnchor"},"t":"a"},"Service Worker with React"],"p":{"id":"service-worker-with-react"},"t":"h2"},"\n",{"c":["I was able to simplify things by using ",{"c":"sw-precache","t":"code"}," for the app shell and adding the optional setting of ",{"c":"runtimeCaching","t":"code"}," for the blog section to use networkFirst."],"t":"p"},"\n",{"c":{"c":"runtimeCaching: [\n  {\n    urlPattern: /\\/blog.*/,\n    handler: \"networkFirst\",\n    options: {\n      cache: {\n        maxEntries: 10,\n        name: \"blog-cache\"\n      }\n    }\n  }\n]\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":["Also had to add some more root globs for precaching as by default was only caching subfolder assets.\n",{"c":"gulpfile.js","t":"code"}],"t":"p"},"\n",{"c":{"c":"staticFileGlobs: [\n  rootDir + \"/**/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}\", //gets subfolder assets\n  rootDir + \"/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}\" //caches root foler assets\n],\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":["I also had to put the registration for the service-worker in the ",{"c":"componentDidMount()","t":"code"},"  function of the layout component since we only have access to the DOM once the component mounts. We need the DOM to access the ",{"c":"window.navigator","t":"code"}," to register the service worker."],"t":"p"}],"t":"div"}}