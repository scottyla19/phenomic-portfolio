<!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body><div id="PhenomicRoot"><div data-reactroot="" data-reactid="1" data-react-checksum="1135573728"><!-- react-empty: 2 --><header data-reactid="3"><div class="header" data-reactid="4"><div class="header-left" data-reactid="5"><div class="header-icon" data-reactid="6"><img src="/laforest-icon-144.png" data-reactid="7"/></div><h4 class="header-name" data-reactid="8">Scott LaForest</h4><p data-reactid="9">Web Developer</p></div><div class="header-right" data-reactid="10"><div style="display:inline-block;position:relative;" data-reactid="11"><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:relative;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button" data-reactid="12"><div data-reactid="13"><span class="material-icons md-36" color="#FF5722" font-size="36px" style="color:#FF5722;position:relative;font-size:24px;display:inline-block;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" data-reactid="14">menu</span></div></button><div style="display:none;" data-reactid="15"><!-- react-empty: 16 --><!-- react-empty: 17 --></div></div></div></div></header><div class="main-container" data-reactid="18"><div class="content" data-reactid="19"><article data-reactid="20"><h1 data-reactid="21">React PWA Notes</h1><h3 data-reactid="22"><!-- react-text: 23 -->Author: <!-- /react-text --><!-- react-text: 24 -->Scott LaForest<!-- /react-text --></h3><div data-reactid="25"><h1 id="notes" data-reactid="26"><a href="#notes" class="phenomic-HeadingAnchor" data-reactid="27">#</a><!-- react-text: 28 -->Notes<!-- /react-text --></h1><!-- react-text: 29 -->
<!-- /react-text --><h2 id="service-worker-with-react" data-reactid="30"><a href="#service-worker-with-react" class="phenomic-HeadingAnchor" data-reactid="31">#</a><!-- react-text: 32 -->Service Worker with React<!-- /react-text --></h2><!-- react-text: 33 -->
<!-- /react-text --><p data-reactid="34"><!-- react-text: 35 -->I was able to simplify things by using <!-- /react-text --><code data-reactid="36">sw-precache</code><!-- react-text: 37 --> for the app shell and adding the optional setting of <!-- /react-text --><code data-reactid="38">runtimeCaching</code><!-- react-text: 39 --> for the blog section to use networkFirst.<!-- /react-text --></p><!-- react-text: 40 -->
<!-- /react-text --><pre data-reactid="41"><code class="language-javascript" data-reactid="42">runtimeCaching: [
  {
    urlPattern: /\/blog.*/,
    handler: &quot;networkFirst&quot;,
    options: {
      cache: {
        maxEntries: 10,
        name: &quot;blog-cache&quot;
      }
    }
  }
]
</code></pre><!-- react-text: 43 -->
<!-- /react-text --><p data-reactid="44"><!-- react-text: 45 -->Also had to add some more root globs for precaching as by default was only caching subfolder assets.
<!-- /react-text --><code data-reactid="46">gulpfile.js</code></p><!-- react-text: 47 -->
<!-- /react-text --><pre data-reactid="48"><code class="language-javascript" data-reactid="49">staticFileGlobs: [
  rootDir + &quot;/**/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}&quot;, //gets subfolder assets
  rootDir + &quot;/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}&quot; //caches root foler assets
],
</code></pre><!-- react-text: 50 -->
<!-- /react-text --><p data-reactid="51"><!-- react-text: 52 -->I also had to put the registration for the service-worker in the <!-- /react-text --><code data-reactid="53">componentDidMount()</code><!-- react-text: 54 -->  function of the layout component since we only have access to the DOM once the component mounts. We need the DOM to access the <!-- /react-text --><code data-reactid="55">window.navigator</code><!-- react-text: 56 --> to register the service worker.<!-- /react-text --></p></div></article></div></div><footer data-reactid="57"><div class="footer" data-reactid="58"><div data-reactid="59"><!-- react-text: 60 -->Scott LaForest © <!-- /react-text --><!-- react-text: 61 -->2017<!-- /react-text --></div><div data-reactid="62"><!-- react-text: 63 -->Created with ❤ using  <!-- /react-text --><a href="https://phenomic.io/" style="color:inherit;" data-reactid="64">Phenomic</a></div><div data-reactid="65"><!-- react-text: 66 -->Check out the source code  <!-- /react-text --><a href="https://github.com/scottyla19/phenomic-portfolio" style="color:inherit;" data-reactid="67"><i class="fa fa-github" data-reactid="68"></i></a></div></div></footer></div></div><script id="PhenomicHydration" type="text/json">{"collection=posts&id=2017-07-06":{"status":"idle","node":{"date":"2017-01-01","title":"React PWA Notes","desc":"Notes while creating my portfolio site. Includes gotchas with service workers, sw-precache, manifext.json.","tags":"React, PWA","author":"Scott LaForest","posted":"07/06/17","body":{"c":[{"c":[{"c":"#","p":{"href":"#notes","className":"phenomic-HeadingAnchor"},"t":"a"},"Notes"],"p":{"id":"notes"},"t":"h1"},"\n",{"c":[{"c":"#","p":{"href":"#service-worker-with-react","className":"phenomic-HeadingAnchor"},"t":"a"},"Service Worker with React"],"p":{"id":"service-worker-with-react"},"t":"h2"},"\n",{"c":["I was able to simplify things by using ",{"c":"sw-precache","t":"code"}," for the app shell and adding the optional setting of ",{"c":"runtimeCaching","t":"code"}," for the blog section to use networkFirst."],"t":"p"},"\n",{"c":{"c":"runtimeCaching: [\n  {\n    urlPattern: /\\/blog.*/,\n    handler: \"networkFirst\",\n    options: {\n      cache: {\n        maxEntries: 10,\n        name: \"blog-cache\"\n      }\n    }\n  }\n]\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":["Also had to add some more root globs for precaching as by default was only caching subfolder assets.\n",{"c":"gulpfile.js","t":"code"}],"t":"p"},"\n",{"c":{"c":"staticFileGlobs: [\n  rootDir + \"/**/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}\", //gets subfolder assets\n  rootDir + \"/*.{js,html,css,png,jpg,gif,svg,eot,ttf,woff}\" //caches root foler assets\n],\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":["I also had to put the registration for the service-worker in the ",{"c":"componentDidMount()","t":"code"},"  function of the layout component since we only have access to the DOM once the component mounts. We need the DOM to access the ",{"c":"window.navigator","t":"code"}," to register the service worker."],"t":"p"}],"t":"div"}}}}</script><script src="/phenomic.main.js" async=""></script></body></html>