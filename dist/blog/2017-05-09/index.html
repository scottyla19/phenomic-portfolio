<!DOCTYPE html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/></head><body><div id="PhenomicRoot"><div data-reactroot="" data-reactid="1" data-react-checksum="1276126791"><!-- react-empty: 2 --><header data-reactid="3"><div class="header" data-reactid="4"><div class="header-left" data-reactid="5"><div class="header-icon" data-reactid="6"><img src="/laforest-icon-144.png" data-reactid="7"/></div><h4 class="header-name" data-reactid="8">Scott LaForest</h4><p data-reactid="9">Web Developer</p></div><div class="header-right" data-reactid="10"><div style="display:inline-block;position:relative;" data-reactid="11"><button style="border:10px;box-sizing:border-box;display:inline-block;font-family:Roboto, sans-serif;-webkit-tap-highlight-color:rgba(0, 0, 0, 0);cursor:pointer;text-decoration:none;margin:0;padding:12px;outline:none;font-size:0;font-weight:inherit;position:relative;z-index:1;overflow:visible;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;width:48px;height:48px;background:none;-moz-box-sizing:border-box;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" tabindex="0" type="button" data-reactid="12"><div data-reactid="13"><span class="material-icons md-36" color="#FF5722" font-size="36px" style="color:#FF5722;position:relative;font-size:24px;display:inline-block;user-select:none;transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-webkit-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;-moz-transition:all 450ms cubic-bezier(0.23, 1, 0.32, 1) 0ms;" data-reactid="14">menu</span></div></button><div style="display:none;" data-reactid="15"><!-- react-empty: 16 --><!-- react-empty: 17 --></div></div></div></div></header><div class="main-container" data-reactid="18"><div class="content" data-reactid="19"><article data-reactid="20"><h1 data-reactid="21">PWA Service Worker Notes</h1><h3 data-reactid="22"><!-- react-text: 23 -->Author: <!-- /react-text --><!-- react-text: 24 -->Scott LaForest<!-- /react-text --></h3><div data-reactid="25"><h1 id="notes" data-reactid="26"><a href="#notes" class="phenomic-HeadingAnchor" data-reactid="27">#</a><!-- react-text: 28 -->Notes<!-- /react-text --></h1><!-- react-text: 29 -->
<!-- /react-text --><ul data-reactid="30"><!-- react-text: 31 -->
<!-- /react-text --><li data-reactid="32">Service workers must be registered.</li><!-- react-text: 33 -->
<!-- /react-text --><li data-reactid="34"><!-- react-text: 35 -->Always start by checking if the browser supports service workers. The service
worker is exposed on the browser&#x27;s <!-- /react-text --><a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator" data-reactid="36">Navigator</a><!-- react-text: 37 --> i.e. <!-- /react-text --><code data-reactid="38">window.navigator.serviceWorker</code></li><!-- react-text: 39 -->
<!-- /react-text --></ul><!-- react-text: 40 -->
<!-- /react-text --><h1 id="sw-life-cycle" data-reactid="41"><a href="#sw-life-cycle" class="phenomic-HeadingAnchor" data-reactid="42">#</a><!-- react-text: 43 -->SW Life Cycle<!-- /react-text --></h1><!-- react-text: 44 -->
<!-- /react-text --><ul data-reactid="45"><!-- react-text: 46 -->
<!-- /react-text --><li data-reactid="47"><!-- react-text: 48 -->The service worker emits an <!-- /react-text --><code data-reactid="49">install</code><!-- react-text: 50 --> event at the end of registration (this is a good place for caching static assets). SW emits an  <!-- /react-text --><code data-reactid="51">activate</code><!-- react-text: 52 --> event when it takes control of the page (is often used to update caches).<!-- /react-text --></li><!-- react-text: 53 -->
<!-- /react-text --></ul><!-- react-text: 54 -->
<!-- /react-text --><pre data-reactid="55"><code class="language-javascript" data-reactid="56">  self.addEventListener(&#x27;install&#x27;, function(event) {
    console.log(&#x27;Service worker installing...&#x27;);
    });

  self.addEventListener(&#x27;activate&#x27;, function(event) {
    console.log(&#x27;Service worker activating...&#x27;);
  });
</code></pre><!-- react-text: 57 -->
<!-- /react-text --><ul data-reactid="58"><!-- react-text: 59 -->
<!-- /react-text --><li data-reactid="60"><!-- react-text: 61 -->
<!-- /react-text --><p data-reactid="62">fetch events are received for every HTTP request (we could also create and return our own custom response with arbitrary resources).</p><!-- react-text: 63 -->
<!-- /react-text --></li><!-- react-text: 64 -->
<!-- /react-text --><li data-reactid="65"><!-- react-text: 66 -->
<!-- /react-text --><p data-reactid="67">Why didn&#x27;t a failed response activate the catch block? This is an important note for fetch and promises—bad responses (like 404s) still resolve! A fetch promise only rejects if the request was unable to complete, so you must always check the validity of the response.</p><!-- react-text: 68 -->
<!-- /react-text --></li><!-- react-text: 69 -->
<!-- /react-text --><li data-reactid="70"><!-- react-text: 71 -->
<!-- /react-text --><p data-reactid="72">Getting headers involves getting a headers object var myHeaders = response.headers then calling the get funciotn on the object. myHeaders.get(name)</p><!-- react-text: 73 -->
<!-- /react-text --></li><!-- react-text: 74 -->
<!-- /react-text --></ul><!-- react-text: 75 -->
<!-- /react-text --><pre data-reactid="76"><code class="language-javascript" data-reactid="77">self.addEventListener(&#x27;fetch&#x27;, function(event) {
    console.log(&#x27;Fetching:&#x27;, event.request.url);
});
</code></pre><!-- react-text: 78 -->
<!-- /react-text --><h1 id="sw-scope" data-reactid="79"><a href="#sw-scope" class="phenomic-HeadingAnchor" data-reactid="80">#</a><!-- react-text: 81 -->SW Scope<!-- /react-text --></h1><!-- react-text: 82 -->
<!-- /react-text --><ul data-reactid="83"><!-- react-text: 84 -->
<!-- /react-text --><li data-reactid="85"><!-- react-text: 86 -->The promise returned by <!-- /react-text --><code data-reactid="87">register()</code><!-- react-text: 88 --> resolves to the registration object, which contains the service worker&#x27;s scope.<!-- /react-text --></li><!-- react-text: 89 -->
<!-- /react-text --></ul><!-- react-text: 90 -->
<!-- /react-text --><p data-reactid="91"><strong data-reactid="92">The default scope is the path to the service worker file, and extends to all lower directories. So a service worker in the root directory of an app controls requests from all files in the app.</strong></p><!-- react-text: 93 -->
<!-- /react-text --><ul data-reactid="94"><!-- react-text: 95 -->
<!-- /react-text --><li data-reactid="96"><!-- react-text: 97 -->
<!-- /react-text --><p data-reactid="98"><!-- react-text: 99 -->Notice if <!-- /react-text --><code data-reactid="100">service-worker.js</code><!-- react-text: 101 --> is in a subdirectory (/below) then the service worker only controls requests for the requests in that subdirectory. The service worker&#x27;s default scope is the path to the service worker file. Since the service worker file is now in app/below/, that is its scope. The console is now only logging fetch events for another.html, another.css, and another.js, because these are the only resources within the service worker&#x27;s scope (app/below/).<!-- /react-text --></p><!-- react-text: 102 -->
<!-- /react-text --></li><!-- react-text: 103 -->
<!-- /react-text --><li data-reactid="104"><!-- react-text: 105 -->
<!-- /react-text --><p data-reactid="106">Can set an arbitrary scope using the options in serviceWorker.register().</p><!-- react-text: 107 -->
<!-- /react-text --></li><!-- react-text: 108 -->
<!-- /react-text --></ul><!-- react-text: 109 -->
<!-- /react-text --><pre data-reactid="110"><code class="language-javascript" data-reactid="111">navigator.serviceWorker.register(&#x27;service-worker.js&#x27;,
{scope: &#x27;./below&#x27;})
.then(function(registration) {
    console.log(&#x27;Registered at scope:&#x27;, registration.scope);
})```
</code></pre></div></article></div></div><footer data-reactid="112"><div class="footer" data-reactid="113"><div data-reactid="114"><!-- react-text: 115 -->Scott LaForest © <!-- /react-text --><!-- react-text: 116 -->2017<!-- /react-text --></div><div data-reactid="117"><!-- react-text: 118 -->Created with ❤ using  <!-- /react-text --><a href="https://phenomic.io/" style="color:inherit;" data-reactid="119">Phenomic</a></div><div data-reactid="120"><!-- react-text: 121 -->Check out the source code  <!-- /react-text --><a href="https://github.com/scottyla19/phenomic-portfolio" style="color:inherit;" data-reactid="122"><i class="fa fa-github" data-reactid="123"></i></a></div></div></footer></div></div><script id="PhenomicHydration" type="text/json">{"collection=posts&id=2017-05-09":{"status":"idle","node":{"date":"2017-01-01","title":"PWA Service Worker Notes","desc":"Notes from the Google PWA Service Worker CodeLab. Includes install, activate, and SW scope.","tags":"PWA","author":"Scott LaForest","posted":"05/09/17","body":{"c":[{"c":[{"c":"#","p":{"href":"#notes","className":"phenomic-HeadingAnchor"},"t":"a"},"Notes"],"p":{"id":"notes"},"t":"h1"},"\n",{"c":["\n",{"c":"Service workers must be registered.","t":"li"},"\n",{"c":["Always start by checking if the browser supports service workers. The service\nworker is exposed on the browser's ",{"c":"Navigator","p":{"href":"https://developer.mozilla.org/en-US/docs/Web/API/Navigator"},"t":"a"}," i.e. ",{"c":"window.navigator.serviceWorker","t":"code"}],"t":"li"},"\n"],"t":"ul"},"\n",{"c":[{"c":"#","p":{"href":"#sw-life-cycle","className":"phenomic-HeadingAnchor"},"t":"a"},"SW Life Cycle"],"p":{"id":"sw-life-cycle"},"t":"h1"},"\n",{"c":["\n",{"c":["The service worker emits an ",{"c":"install","t":"code"}," event at the end of registration (this is a good place for caching static assets). SW emits an  ",{"c":"activate","t":"code"}," event when it takes control of the page (is often used to update caches)."],"t":"li"},"\n"],"t":"ul"},"\n",{"c":{"c":"  self.addEventListener('install', function(event) {\n    console.log('Service worker installing...');\n    });\n\n  self.addEventListener('activate', function(event) {\n    console.log('Service worker activating...');\n  });\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":["\n",{"c":["\n",{"c":"fetch events are received for every HTTP request (we could also create and return our own custom response with arbitrary resources).","t":"p"},"\n"],"t":"li"},"\n",{"c":["\n",{"c":"Why didn't a failed response activate the catch block? This is an important note for fetch and promises—bad responses (like 404s) still resolve! A fetch promise only rejects if the request was unable to complete, so you must always check the validity of the response.","t":"p"},"\n"],"t":"li"},"\n",{"c":["\n",{"c":"Getting headers involves getting a headers object var myHeaders = response.headers then calling the get funciotn on the object. myHeaders.get(name)","t":"p"},"\n"],"t":"li"},"\n"],"t":"ul"},"\n",{"c":{"c":"self.addEventListener('fetch', function(event) {\n    console.log('Fetching:', event.request.url);\n});\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"},"\n",{"c":[{"c":"#","p":{"href":"#sw-scope","className":"phenomic-HeadingAnchor"},"t":"a"},"SW Scope"],"p":{"id":"sw-scope"},"t":"h1"},"\n",{"c":["\n",{"c":["The promise returned by ",{"c":"register()","t":"code"}," resolves to the registration object, which contains the service worker's scope."],"t":"li"},"\n"],"t":"ul"},"\n",{"c":{"c":"The default scope is the path to the service worker file, and extends to all lower directories. So a service worker in the root directory of an app controls requests from all files in the app.","t":"strong"},"t":"p"},"\n",{"c":["\n",{"c":["\n",{"c":["Notice if ",{"c":"service-worker.js","t":"code"}," is in a subdirectory (/below) then the service worker only controls requests for the requests in that subdirectory. The service worker's default scope is the path to the service worker file. Since the service worker file is now in app/below/, that is its scope. The console is now only logging fetch events for another.html, another.css, and another.js, because these are the only resources within the service worker's scope (app/below/)."],"t":"p"},"\n"],"t":"li"},"\n",{"c":["\n",{"c":"Can set an arbitrary scope using the options in serviceWorker.register().","t":"p"},"\n"],"t":"li"},"\n"],"t":"ul"},"\n",{"c":{"c":"navigator.serviceWorker.register('service-worker.js',\n{scope: './below'})\n.then(function(registration) {\n    console.log('Registered at scope:', registration.scope);\n})```\n","p":{"className":"language-javascript"},"t":"code"},"t":"pre"}],"t":"div"}}}}</script><script src="/phenomic.main.js" async=""></script></body></html>